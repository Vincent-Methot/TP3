\documentclass[a4paper]{article}
\input{sty_file.sty}

\title{TP3 - IMN530}

\author{FOUQUET, Jérémie et MÉTHOT, Vincent}

\date{28 avril 2014}

\begin{document}
\maketitle

\section{IRM fonctionnelle}

Plusieurs outils d'analyse existent déjàpour traiter des données d'IRMf. Nous avons choisis de les utiliser directement plutôt que de les implémenter en python. Deux suites logicielles ont retenu notre intérêt (puisque nous les connaissons déjà), soit FSL [\url{http://fsl.fmrib.ox.ac.uk/fsl/fslwiki/}] et AFNI [\url{http://afni.nimh.nih.gov/}], qu'il faudra avoir installé pour faire fonctionner le script associé à ce numéro (Q1\_IRMf.sh).

\subsection{Étapes de reconstruction}

Il faut garder à l'esprit qu'à chaque étape de reconstruction, il est fortement conseillé d'inspecter visuellement les données. Dès leur réception, on a visuellement inspecté plusieurs tranches de \emph{fmri.nii} à tous les temps pour s'assurer que les artéfacts n'étaient pas trop important et que la correction de mouvement n'était pas nécessaire (voir Fig. \ref{fmri_anatomist}), comme mentionné dans la question. De plus, nous avons effectué une transformée de Fourier des séries temporelles (voir Fig. \ref{fmri_fft}).

\begin{figure}[h]
   \caption{\label{fmri_anatomist} Inspection visuelle de fmri.nii dans anatomist. On peut inspecter plusieurs tranches pour tous les points temporels à l'aide des deux curseurs à droite, comme dans un film.}
   \centering
   \includegraphics[width=\textwidth]{fmri_anatomist}
\end{figure}

\begin{figure}[h]
   \caption{\label{fmri_fft} Coupe sagitale de la transformée de Fourier de fmri.nii à chaque point. Une fréquence près de 0.02 Hz (la fréquence fondamentale du stimulus) est affichée dans AFNI. Les zones blanches peuvent être dues à de l'activation cérébrale mais aussi (et surtout) à un effet de bord relié à du mouvement.}
   \centering
   \includegraphics[width=\textwidth]{fmri_fft}
\end{figure}

Les étapes de reconstruction suivantes furent appliquées sur les données d'IRMf. Le résultat de chacune est illustrée sur la Fig. \ref{fmri_reconstruction}. On y voit sur la première ligne l'image originale (\ref{fmri_reconstruction}A - \emph{fmri.nii}) et les séries temporelles de quelques voxels voisins (\ref{fmri_reconstruction}B). Sur la deuxième ligne, il y a le résultat de la première étape de reconstruction ( \ref{fmri_reconstruction} A \& B \emph{fmri\_smooth.nii.gz}), c'est-à-dire l'image débruitée. Cette étape a pour but d'augmenter le rapport signal sur bruit par une convolution avec une gaussienne de FWHM = 6mm.
% Il y aurait avantage à utiliser un filtrage bilatéral, ou quelque chose de plus poussé...
La troisième ligne montre le résultat du filtrage temporel sur chaque voxel (\ref{fmri_reconstruction}E \emph{fmri\_low.nii.gz}). On voit par le fait même que la valeur moyenne de chaque voxel est fixée à 0, ne laissant que les variations temporelles. Comme du bruit et des artéfacts de nature physiologique se retrouvent aux hautes fréquences, nous avous décidé de couper les fréquences supérieures à 0.06 Hz (sachant que notre signal idéal à un fréquence fondamentale de 0.02 Hz) de chacune de nos séries temporelles (\ref{fmri_reconstruction}F).
La dernière étape de reconstruction consiste à calculer voxel par voxel une corrélation entre le signal idéal (contenu dans le fichier \emph{Data/ideal.txt}) et mesuré.  On en tire une carte de coefficients de corrélation entre -1 et 1 (\ref{fmri_reconstruction}F). On pourra ensuite seuiller cette carte pour obtenir un masque binaire des zones d'activations. La comparaison entre \ref{fmri_reconstruction}B et \ref{fmri_reconstruction}H montre l'effet du processus de reconstruction sur les données d'IRMf aurant au niveau spatial que temporel.

\begin{figure}[h]
   \caption{\label{fmri_reconstruction} A - Image originelle. B - Séries temporelles pour quelques voxels adjacents de l'image originelle. C - Image débruitée (convolution avec une gaussienne de FWHM = 6mm). D - Série temporelle débruitée. E - Image après passage d'une filtre passe-bas. La valeur moyenne (fréquence nulle) représentant l'information structurelle est perdue. F - Série temporelle de l'image filtrée. G - Corrélation point à point (seuillé à $\rho > 0.5$). H - Séries temporelles pour quelques voxels adjacents de l'image reconstruite. Position du point sélectionné: x = 22, y = 13, z = 24. Les séries temporelles rouge représentent le signal idée. Celles en noir représentent le signal mesuré/transformées.}
   \centering
   \includegraphics[height=0.85\textheight]{fmri_reconstruction}
\end{figure}


\subsection{Segmentation}

On a effectué la segmentation des zones d'activation à l'aide de l'outil graphique d'AFNI, de manière à trouver les paramètres idéaux en fonction des zones qu'on voulait voir activer. Puisque la tâche Roland est une tâche requérant des fonctions motrices, et mémoire et de vision, on s'attend à voir \og allumer \fg~ 6 zones reliées à ces activités. Les tâches motrices sont principalement localisées dans le cortex moteur (gyrus précentral). La mémoire est principalement localisée dans l'hippocampe. La vision est principalement localisée dans le cortex occipital. Nous nous sommes donc servis de nos connaissances anatomiques \emph{a priori} pour réaliser la segmentation et le regroupement des voxels activés (\emph{clustering}).

L'étape de segmentation dans le script \emph{Q1\_IRMf.sh} réalise l'opération de seuillage et de regroupement automatiquement, donnant 7 régions distinctes, dont chaqu'une est étiquetée avec une valeur diffénte:
	
\begin{enumerate}
    \item Lobe occipital droit (vision)
    \item Lobe occipital gauche (vision)
    \item Hippocampe gauche (mémoire)
    \item Hippocampe droit (mémoire)
    \item Gyrus précentral droite (mouvement)
    \item Région hors du cerveau (artéfact)
    \item Gyrus précentral gauche (mouvement)
\end{enumerate}

La méthode de segmentation utilisée consiste en un seuillage simple des valeurs de coefficient de corrélation (on ne garde que celles entre 0.5149 et 1), puis le \emph{clustering} de AFNI enlève les voxels n'étant pas regroupés. Plus précisément, les groupes comportant moins de 50 voxels voisins sont mis à zéro.

\subsection{Zones d'activation}



\section{IRM de diffusion}

\subsection{Estimation des tenseurs}

\subsection{FA et ADC}

\subsection{Tractographie}




\section{Fusion}

\subsection{Justification}

\subsection{Connectivité des zones fonctionnelles}





\section{Bonus}

\subsection{FA et ADC}

\subsection{Tractographie avec Dipy}


\end{document}